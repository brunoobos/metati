<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meta TI - Sistema de Estudos</title>
    <style>
        * { 
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        
        /* Menu Superior */
        .top-menu {
            background-color: #2c3e50;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .logo {
            color: white;
            font-weight: bold;
            font-size: 1.5em;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        .nav-links li {
            position: relative;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 20px 15px;
            display: block;
            transition: background-color 0.3s;
        }
        
        .nav-links a:hover {
            background-color: #34495e;
        }
        
        .dropdown {
            position: relative;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            z-index: 1;
        }
        
        .dropdown-content a {
            color: #333;
            padding: 12px 16px;
        }
        
        .dropdown-content a:hover {
            background-color: #ddd;
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        .menu-toggle {
            display: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            padding: 15px;
        }
        
        header {
            background-color: #3498db;
            color: white;
            text-align: center;
            padding: 30px 0;
            position: relative;
        }
        
        h1 {
            margin: 0;
            font-size: 2em;
        }
        
        .progress-summary {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px;
            margin: 20px auto;
            max-width: 1200px;
            text-align: center;
        }
        
        .progress-bar {
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #2ecc71;
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .states-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 30px auto;
            padding: 20px;
            max-width: 1200px;
        }
        
        .state-btn {
            padding: 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.9em;
            width: 250px;
        }
        
        .state-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .state-info {
            display: none;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 25px;
            margin-top: 20px;
        }
        
        .state-info h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 0;
        }
        
        .category {
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            background-color: #f9f9f9;
        }
        
        .category h3 {
            color: #3498db;
            margin-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .category-progress {
            font-size: 0.8em;
            color: #7f8c8d;
        }
        
        .content-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 4px;
            background-color: white;
            transition: all 0.3s;
        }
        
        .content-item:hover {
            background-color: #f0f0f0;
        }
        
        .content-item.completed {
            background-color: #e8f6ef;
            border-left: 4px solid #2ecc71;
        }
        
        .content-checkbox {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .content-text {
            flex: 1;
        }
        
        .content-actions {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }
        
        .content-link {
            padding: 5px 10px;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.8em;
            transition: background-color 0.3s;
            white-space: nowrap;
        }
        
        .content-link:hover {
            background-color: #2980b9;
        }
        
        .edit-link-btn {
            padding: 5px 8px;
            background-color: #f39c12;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
        }
        
        .edit-link-btn:hover {
            background-color: #e67e22;
        }
        
        .add-link-btn {
            padding: 5px 10px;
            background-color: #95a5a6;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
        }
        
        .add-link-btn:hover {
            background-color: #7f8c8d;
        }
        
        .link-input-container {
            display: none;
            margin-top: 5px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
            grid-column: 1 / -1;
        }
        
        .link-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9em;
        }
        
        .link-actions {
            display: flex;
            gap: 5px;
        }
        
        .link-save, .link-cancel, .link-remove {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .link-save {
            background-color: #2ecc71;
            color: white;
        }
        
        .link-cancel {
            background-color: #e74c3c;
            color: white;
        }
        
        .link-remove {
            background-color: #e74c3c;
            color: white;
        }
        
        .state-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        footer {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        .search-container {
            margin: 20px 0;
            text-align: center;
        }
        
        .search-input {
            padding: 10px 15px;
            width: 300px;
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1em;
        }
        
        .search-filters {
            margin-top: 10px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
        }
        
        .filter-btn {
            padding: 8px 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .filter-btn:hover {
            background-color: #2980b9;
        }
        
        .filter-btn.active {
            background-color: #2c3e50;
        }
        
        .sync-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.8em;
            z-index: 1000;
        }
        
        .sync-status.online {
            background-color: #2ecc71;
            color: white;
        }
        
        .sync-status.offline {
            background-color: #e74c3c;
            color: white;
        }
        
        .sync-btn {
            position: fixed;
            bottom: 60px;
            right: 20px;
            padding: 8px 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            z-index: 1000;
        }
        
        /* Novos estilos para o ciclo de estudos */
        .study-cycle-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin: 20px 0;
        }
        
        .study-cycle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        .study-cycle-title {
            color: #2c3e50;
            margin: 0;
            font-size: 1.5em;
        }
        
        .study-cycle-controls {
            display: flex;
            gap: 10px;
        }
        
        .cycle-btn {
            padding: 8px 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 0.9em;
        }
        
        .cycle-btn:hover {
            background-color: #2980b9;
        }
        
        .cycle-btn.reset {
            background-color: #e74c3c;
        }
        
        .cycle-btn.reset:hover {
            background-color: #c0392b;
        }
        
        .study-cycle-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .cycle-day {
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 15px;
            transition: all 0.3s;
        }
        
        .cycle-day.current {
            background-color: #e8f6ef;
            border-color: #2ecc71;
            box-shadow: 0 2px 5px rgba(46, 204, 113, 0.3);
        }
        
        .cycle-day.completed {
            background-color: #e8f6ef;
            border-color: #2ecc71;
        }
        
        .cycle-day.future {
            background-color: #fef9e7;
            border-color: #f39c12;
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .day-title {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .day-status {
            font-size: 0.8em;
            padding: 2px 8px;
            border-radius: 10px;
            background-color: #ecf0f1;
            color: #7f8c8d;
        }
        
        .day-status.current {
            background-color: #3498db;
            color: white;
        }
        
        .day-status.completed {
            background-color: #2ecc71;
            color: white;
        }
        
        .study-items {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .study-item {
            padding: 5px 0;
            border-bottom: 1px dashed #e0e0e0;
            font-size: 0.9em;
        }
        
        .study-item:last-child {
            border-bottom: none;
        }
        
        .study-item.completed {
            color: #27ae60;
            text-decoration: line-through;
        }
        
        .study-item.current {
            font-weight: bold;
            color: #3498db;
        }
        
        .cycle-progress {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #e0e0e0;
        }
        
        .cycle-progress-bar {
            height: 8px;
            background-color: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }
        
        .cycle-progress-fill {
            height: 100%;
            background-color: #2ecc71;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .cycle-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            color: #7f8c8d;
        }
        
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
            
            .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                position: absolute;
                top: 60px;
                left: 0;
                background-color: #2c3e50;
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .nav-links li {
                text-align: center;
            }
            
            .dropdown-content {
                position: static;
                box-shadow: none;
            }
            
            .states-container {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .state-categories {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .content-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .content-actions {
                margin-left: 0;
                margin-top: 5px;
                width: 100%;
                justify-content: flex-start;
            }
            
            .content-link, .edit-link-btn, .add-link-btn {
                flex: 1;
                text-align: center;
            }
            
            .sync-status, .sync-btn {
                bottom: 10px;
                right: 10px;
            }
            
            .sync-btn {
                bottom: 50px;
            }
            
            .study-cycle-content {
                grid-template-columns: 1fr;
            }
            
            .study-cycle-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .study-cycle-controls {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <div class="top-menu">
        <a href="#" class="logo">Concursos TI</a>
        <div class="menu-toggle">☰</div>
        <ul class="nav-links">
            <li><a href="#">Início</a></li>
            <li><a href="#progresso">Meu Progresso</a></li>
            <li><a href="#disciplinas">Disciplinas</a></li>
            <li><a href="#ciclo">Ciclo de Estudos</a></li>
        </ul>
    </div>
    
    <header>
        <h1>Meta TI</h1>
        <p>Preparação para concursos públicos na área de Tecnologia da Informação</p>
    </header>

    <div class="progress-summary">
        <h3>Meu Progresso Geral</h3>
        <div class="progress-bar">
            <div class="progress-fill" id="overallProgress" style="width: 0%"></div>
        </div>
        <p id="progressText">0% concluído</p>
    </div>

    <div class="container">
        <div class="search-container">
            <input type="text" class="search-input" placeholder="Pesquisar órgãos, disciplinas ou conteúdos...">
            <div class="search-filters">
                <div class="filter-option">
                    <input type="radio" id="filter-all" name="search-filter" value="all" checked>
                    <label for="filter-all">Todos</label>
                </div>
                <div class="filter-option">
                    <input type="radio" id="filter-orgao" name="search-filter" value="orgao">
                    <label for="filter-orgao">Órgãos</label>
                </div>
                <div class="filter-option">
                    <input type="radio" id="filter-disciplina" name="search-filter" value="disciplina">
                    <label for="filter-disciplina">Disciplinas</label>
                </div>
                <div class="filter-option">
                    <input type="radio" id="filter-conteudo" name="search-filter" value="conteudo">
                    <label for="filter-conteudo">Conteúdos</label>
                </div>
            </div>
        </div>
        
        <!-- Ciclo de Estudos -->
        <div class="study-cycle-container" id="studyCycleContainer" style="display: none;">
            <div class="study-cycle-header">
                <h3 class="study-cycle-title">Ciclo de Estudos - <span id="currentDisciplineName">Disciplina</span></h3>
                <div class="study-cycle-controls">
                    <button class="cycle-btn" id="prevDayBtn">← Dia Anterior</button>
                    <button class="cycle-btn" id="nextDayBtn">Próximo Dia →</button>
                    <button class="cycle-btn reset" id="resetCycleBtn">Reiniciar Ciclo</button>
                </div>
            </div>
            <div class="study-cycle-content" id="studyCycleContent">
                <!-- Os dias do ciclo serão gerados dinamicamente aqui -->
            </div>
            <div class="cycle-progress">
                <div class="cycle-stats">
                    <span id="cycleProgressText">Progresso do Ciclo: 0%</span>
                    <span id="cycleDayInfo">Dia 1 de 7</span>
                </div>
                <div class="cycle-progress-bar">
                    <div class="cycle-progress-fill" id="cycleProgressFill" style="width: 0%"></div>
                </div>
            </div>
        </div>
        
        <div class="states-container">
            <button class="state-btn" data-state="TCU">TCU</button>
            <button class="state-btn" data-state="TCE_RJ">TCE RJ</button>
            <button class="state-btn" data-state="TCE_SC">TCE SC</button>
        </div>
        
        <div id="stateInfo" class="state-info">
            <h2 id="stateName">Órgão</h2>
            <div class="controls">
                <button class="filter-btn active" data-filter="all">Todos</button>
                <button class="filter-btn" data-filter="pending">Pendentes</button>
                <button class="filter-btn" data-filter="completed">Concluídos</button>
                <button class="filter-btn" id="startCycleBtn" style="background-color: #9b59b6;">Iniciar Ciclo</button>
            </div>
            
            <div class="state-categories">
                <div class="category" data-disciplina="GESTÃO DE TI">
                    <h3>GESTÃO DE TI <span class="category-progress" id="gestaoTIProgress">0/0</span></h3>
                    <div class="links" id="gestaoTILinks"></div>
                </div>
                
                <div class="category" data-disciplina="CONTRATAÇÕES DE TI">
                    <h3>CONTRATAÇÕES DE TI <span class="category-progress" id="contratacaoTIProgress">0/0</span></h3>
                    <div class="links" id="contratacaoTILinks"></div>
                </div>
                
                <div class="category" data-disciplina="INTELIGÊNCIA ARTIFICIAL">
                    <h3>INTELIGÊNCIA ARTIFICIAL <span class="category-progress" id="inteligenciaArtificialProgress">0/0</span></h3>
                    <div class="links" id="inteligenciaArtificialLinks"></div>
                </div>
                
                <div class="category" data-disciplina="COMPUTAÇÃO EM NUVEM">
                    <h3>COMPUTAÇÃO EM NUVEM <span class="category-progress" id="computacaoNuvemProgress">0/0</span></h3>
                    <div class="links" id="computacaoNuvemLinks"></div>
                </div>

                <div class="category" data-disciplina="SEGURANÇA DA INFORMAÇÃO">
                    <h3>SEGURANÇA DA INFORMAÇÃO <span class="category-progress" id="segurancaInformacaoProgress">0/0</span></h3>
                    <div class="links" id="segurancaInformacaoLinks"></div>
                </div>
                
                <div class="category" data-disciplina="ENGENHARIA DE SOFTWARE">
                    <h3>ENGENHARIA DE SOFTWARE <span class="category-progress" id="engenhariaSoftwareProgress">0/0</span></h3>
                    <div class="links" id="engenhariaSoftwareLinks"></div>
                </div>
                
                <div class="category" data-disciplina="ENGENHARIA DE DADOS">
                    <h3>ENGENHARIA DE DADOS <span class="category-progress" id="engenhariaDadosProgress">0/0</span></h3>
                    <div class="links" id="engenhariaDadosLinks"></div>
                </div>
                
                <div class="category" data-disciplina="INFRAESTRUTURA DE TI">
                    <h3>INFRAESTRUTURA DE TI <span class="category-progress" id="infraestruturaTIProgress">0/0</span></h3>
                    <div class="links" id="infraestruturaTILinks"></div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Atualizado em <span id="updateDate"></span> | Meta TI - Preparação para Concursos</p>
        <p>© 2025 Meta TI - Todos os direitos reservados</p>
    </footer>

    <button class="sync-btn" id="syncButton">🔄 Sincronizar</button>
    <div class="sync-status offline" id="syncStatus">Offline</div>

    <script>
        // Configuração do Google Apps Script
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxMYxUEqiFbclyT1in7J6Ts87U0o2PjgZW6SN1Yw7xFO0jgS07l89xbrguYTt_frMW-/exec';
        
        // Data de atualização
        document.getElementById('updateDate').textContent = new Date().toLocaleDateString('pt-BR');
        
        // Menu responsivo
        document.querySelector('.menu-toggle').addEventListener('click', function() {
            document.querySelector('.nav-links').classList.toggle('active');
        });
        
        // Dados atualizados com disciplinas de TI (mantido igual)
        const stateLinks = {
            'TCU': {
                gestaoTI: [
                    { text: '1 Gerenciamento de serviços (ITIL v4): conceitos básicos, estrutura e objetivos' },
                    { text: '2 Governança de TI (COBIT 5): conceitos básicos, estrutura e objetivos' },
                    { text: '3 Metodologias ágeis: Scrum, XP, Kanban, TDD, BDD e DDD' }
                ],
                contratacaoTI: [
                    { text: '1 Etapas da Contratação de Soluções de TI. Estudo técnico preliminar (ETP). Termo de Referência (TR) e Projeto Básico' },
                    { text: '2 Tipos de Soluções e Modelos de Serviço. Contratação de software sob demanda, licenciamento, SaaS, IaaS, PaaS. Fábrica de software e sustentação de sistemas. Serviços de infraestrutura em nuvem e data center. Serviços gerenciados de TI e outsourcing' },
                    { text: '3 Governança, Fiscalização e Gestão de Contratos. Papéis e responsabilidades: gestor, fiscal técnico, fiscal administrativo. Indicadores de nível de serviço (SLAs) e penalidades. Gestão de mudanças contratuais e reequilíbrio econômico-financeiro.' },
                    { text: '4 Riscos e Controles em Contratações. Identificação, análise e resposta a riscos em contratos de TI. Controles internos aplicáveis às contratações públicas. Auditoria e responsabilização (jurídica e administrativa)' },
                    { text: '5 Aspectos Técnicos e Estratégicos. Integração com o PDTIC e alinhamento com a estratégia institucional. Mapeamento e definição de requisitos técnicos e não funcionais. Sustentabilidade, acessibilidade e segurança da informação nos contratos' },
                    { text: '6 Legislação e Normativos Aplicáveis. Lei nº 14.133/2021, Decreto nº 10.540/2020, Lei nº 13.709/2018 – LGPD (impactos em contratos de TI). Instruções Normativas da Administração Pública. IN SGD/ME nº 01/2019 – Planejamento das contratações de soluções de TI. IN SGD/ME nº 94/2022 – Governança, Gestão e Fiscalização de Contratos de TI. IN SGD/ME nº 65/2021 – Gestão de riscos em contratações de TI.' }
                ],
                inteligenciaArtificial: [
                    { text: '1 Aprendizado de Máquina: supervisionado, não supervisionado, semi-supervisionado, aprendizado por reforço, análise preditiva.' },
                    { text: '2 Redes Neurais e Deep Learning. Arquiteturas de redes neurais, Frameworks, técnicas de treinamento e aplicações' },
                    { text: '3 Processamento de linguagem natural. Modelos, pré-processamento, agentes inteligentes e sistemas multiagentes.' },
                    { text: '4 Inteligência Artificial Generativa' },
                    { text: '5 Arquitetura e engenharia de sistemas de IA. MLOps. Deploy de modelos. Integração com computação em nuvem' },
                    { text: '6 Ética, Transparência e Responsabilidade em IA. Explicabilidade e interpretabilidade de modelos. Viés algorítmico e discriminação. LGPD e impactos regulatórios da IA. Princípios éticos para uso de IA.' }
                ],
                computacaoNuvem: [
                    { text: '1 Fundamentos de Computação em Nuvem. Modelos de serviço: IaaS, PaaS, SaaS. Modelos de implantação: nuvem pública, privada, híbrida. Arquitetura orientada a serviços (SOA) e microsserviços. Elasticidade, escalabilidade e alta disponibilidade' },
                    { text: '2 Plataformas e Serviços de Nuvem: AWS, Microsoft Azure e Google Cloud Platform.' },
                    { text: '3 Arquitetura de Soluções em Nuvem. Design de sistemas distribuídos resilientes. Arquiteturas serverless e event-driven. Balanceamento de carga e auto escalonamento. Containers e orquestração (Docker, Kubernetes)' },
                    { text: '4 Redes e Segurança em Nuvem. VPNs, sub-redes, gateways e grupos de segurança. Gestão de identidade e acesso (IAM, RBAC, MFA). Criptografia em trânsito e em repouso (TLS, KMS). Zero Trust Architecture em ambientes de nuvem. VPNs site-to-site, Direct Connect, ExpressRoute' },
                    { text: '5 DevOps, CI/CD e Infraestrutura como Código (IaC). Ferrramentas: Terraform. Pipelines de integração e entrega contínua (Jenkins, GitHub Actions). Observabilidade: monitoramento, logging, tracing (CloudWatch, Azure Monitor, GCloud Monitoring).' },
                    { text: '6 Governança, Compliance e Custos. Gerenciamento de custos e otimização de recursos. Políticas de uso e governança em nuvem (tagueamento, cotas, limites). Conformidade com normas e padrões (ISO/IEC 27001, NIST 800-53, LGPD). FinOps' },
                    { text: '7 Armazenamento e Processamento de Dados. Tipos de armazenamento: objetos, blocos, arquivos. Data Lakes e processamento distribuído. Integração com Big Data e A' },
                    { text: '8 Migração e Modernização de Aplicações. Estratégias de migração. Ferramentas de migração (AWS Migration Hub, Azure Migrate, GCloud Migration Center).' },
                    { text: '9 Multicloud. Arquiteturas multicloud e híbridas; Nuvem soberana e soberania de dados' },
                    { text: '10 Normas sobre computação em nuvem no governo federal.' }
                ],
                segurancaInformacao: [
                    { text: '1 Gestão de Identidades e Acesso. Autenticação e Autorização, Single Sign-On (SSO), Security Assertion Markup Language (SAML), OAuth2 e OpenId Connect' },
                    { text: '2 Privacidade e segurança por padrão.' },
                    { text: '3 Malware. virus, keylogger, trojan, spyware, backdoor, worms, rootkit, adware, fileless, ransomware.' },
                    { text: '4 Controles e testes de segurança para aplicações Web e Web Services.' },
                    { text: '5 Múltiplos Fatores de Autenticação (MFA)' },
                    { text: '6 Soluções para Segurança da Informação. Firewall, Intrusion Detection System (IDS), Intrusion Prevention System (IPS), Security Information and Event Management (SIEM), Proxy, Identity Access Management (IAM), Privileged Access Management (PAM), Antivírus, Antispam.' },
                    { text: '7 Frameworks de segurança da informação e segurança cibernética. MITRE ATT&CK, CIS Controls e NIST CyberSecurity Framework (NIST CSF)' },
                    { text: '8 Tratamento de Incidentes Cibernéticos' },
                    { text: '9 Assinatura e certificação digital, criptografia e proteção de dados em trânsito e em repouso' },
                    { text: '10 Segurança em nuvens e de contêineres' },
                    { text: '11 Ataques a redes de computadores. DoS, DDoS, botnets, phishing, zero-day exploits, ping da morte, UDP Flood, MAC flooding, IP spoofing, ARP spoofing, buffer overflow, SQL injection, Cross-Site Scripting (XSS), DNS Poisoning.' }
                ],
                engenhariaSoftware: [
                    { text: '1 Arquitetura de Software. Padrões arquiteturais. Monolito. Microserviços, Serverless. Arquitetura orientada à eventos e mensageria. Padrões de integração (API Gateway, Service Mesh, CQRS). ' },
                    { text: '2 Design e Programação. Padrões de projeto (GoF e Grasp). Concorrência, paralelismo, multithreading e programação assíncrona.' },
                    { text: '3 APIs e Integrações. Design e versionamento de APIs RESTful. Boas práticas de autenticação/autorização (OAuth2, JWT, OpenID Connect).' },
                    { text: '4 Persistência de Dados. Modelagem relacional e normalização. Bancos NoSQL (MongoDB e ElasticSearch). Versionamento e migração de esquemas.' },
                    { text: '5 DevOps e Integração Contínua. Pipelines of CI/CD (GitHub Actions). Build, testes e deploy automatizados. Docker e orquestração com Kubernetes. Monitoramento e observabilidade: Grafana e New Relic.' },
                    { text: '6 Testes e Qualidade de Código. Testes automatizados: unitários, integração, contrato (API). Análise estática de código e cobertura (SonarQube). ' },
                    { text: '7 Linguagens de programação Java' },
                    { text: '8 Desenvolvimento seguro. DevSecOps' }
                ],
                engenhariaDados: [
                    { text: '1 Bancos de Dados. Relacionais: Oracle e Microsoft SQL Server. Não relacionais (NoSQL): Elasticsearch e MongoDB. Modelagens de dados. Relacional, multidimensional, nosql. SQL (Procedural Language / Structured Query Language).' },
                    { text: '2 Arquitetura de Inteligência de Negócio. DataWarehouse, DataMart, DataLake, DataMesh. ' },
                    { text: '3 Conectores e integração com fontes de dados. APIs REST/SOAP, Web Services. Arquivos planos (CSV, JSON, XML, Parquet). Mensageria e eventos. Controle de Integridade de dados. Segurança na captação de dados (TLS, autenticação, mascaramento). Estratégias de buffer e ordenação' },
                    { text: '4 Fluxo de manipulação de dados. ETL. Pepiline de dados: versionamento, logging e auditoria, tolerância a falhas, retries e checkpoints, Integração com CI/CD' },
                    { text: '5 Governança e Qualidade de Dados. Linhagem e catalogação. Qualidade de dados: validação, conformidade, deduplicação. Metadados, glossários de dados, políticas de acesso.' },
                    { text: '6 Integração com nuvem. Serviços gerenciados (Azure Data Factory, Azure Service Fabric, Azure Databricks). Armazenamento (S3, Azure Blob, GCS). Integração com serviços de IA e análise.' }
                ],
                infraestruturaTI: [
                    { text: '1 Arquitetura Infraestrutura de TI. Topologias físicas e lógicas de redes corporativas. Arquiteturas de data center (on-premises, cloud, híbrida). Infraestrutura hiperconvergente. Arquitetura escalável, tolerante a falhas e redundante' },
                    { text: '2 Redes e Comunicação de Dados. Protocolos de comunicação de dados TCP, UDP, SCTP, ARP, TLS, SSL, OSPF, BGP, DNS, DHCP, ICMP, FTP, SFTP, SSH, HTTP, HTTPS, SMTP, IMAP, POP3. VLANs, STP, QoS, roteamento e switching em ambientes corporativos. SDN (Software Defined Networking) e redes programáveis. Wireless corporativo: Wi-Fi 6, WPA3, roaming, mesh.' },
                    { text: '3 Sistemas Operacionais e Servidores. Administração avançada de Linux e Windows Server. Virtualização (KVM, VMware vSphere/ESXi. Serviços de diretório (Active Directory, LDAP). Gerenciamento de usuários, permissões, GPOs.' },
                    { text: '4 Armazenamento e Backup. SAN, NAS, DAS: arquiteturas e protocolos (iSCSI, NFS, SMB). RAID (níveis, vantagens, hot-spare). Backup e recuperação: RPO, RTO, snapshots, deduplicação. Oracle RMAN' },
                    { text: '5 Segurança de Infraestrutura. Hardening de servidores e dispositivos de rede. Firewalls (NGFW), IDS/IPS, proxies, NAC. VPNs, SSL/TLS, PKI, criptografia de dados. Segmentação de rede e zonas de segurança.' },
                    { text: '6 Monitoramento, Gestão e Automação. Ferramentas: Zabbix, New Relic e Grafana. Gerência de capacidade, disponibilidade e desempenho. ITIL v4: incidentes, problemas, mudanças e configurações (CMDB). Scripts e automação com PowerShell, Bash e Puppet. ' },
                    { text: '7 Alta Disponibilidade e Recuperação de Desastres. Clusters de alta disponibilidade e balanceamento de carga. Failover, heartbeat, fencing. Planos de continuidade de negócios e testes de DR' }
                ]
            },
            'TCE_RJ': {
                gestaoTI: [
                    { text: 'Gestão de TI para TCE RJ - ITIL e COBIT' }
                ],
                segurancaInformacao: [
                    { text: 'Segurança da Informação em Tribunais de Contas' }
                ]
            },
            'TCE_SC': {
                gestaoTI: [
                    { text: 'Gestão de TI para TCE SC - ITIL e COBIT' }
                ],
                segurancaInformacao: [
                    { text: 'Segurança da Informação em Tribunais de Contas' }
                ]
            }
        };

        // Sistema de progresso
        let progressData = {};
        let linkData = {};
        let isOnline = false;
        let currentState = null;
        
        // Sistema de ciclo de estudos
        let studyCycleData = {
            currentDiscipline: null,
            currentDay: 1,
            totalDays: 7,
            days: {},
            disciplineProgress: {}
        };

        // Função para fazer requisições para o Google Apps Script
        async function makeRequest(action, data = {}) {
            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: action,
                        data: data
                    })
                });
                
                const result = await response.json();
                isOnline = true;
                updateSyncStatus();
                return result;
            } catch (error) {
                console.error('Erro na requisição:', error);
                isOnline = false;
                updateSyncStatus();
                return loadFromLocalStorage(action);
            }
        }

        // Fallback para localStorage
        function loadFromLocalStorage(action) {
            if (action === 'getProgress') {
                const storedProgress = JSON.parse(localStorage.getItem('progressData')) || {};
                const storedLinkData = JSON.parse(localStorage.getItem('linkData')) || {};
                const storedStudyCycle = JSON.parse(localStorage.getItem('studyCycleData')) || studyCycleData;
                
                return {
                    success: true,
                    progressData: storedProgress,
                    linkData: storedLinkData,
                    studyCycleData: storedStudyCycle
                };
            }
            return { success: false };
        }

        // Atualizar status de sincronização
        function updateSyncStatus() {
            const syncStatus = document.getElementById('syncStatus');
            if (isOnline) {
                syncStatus.textContent = 'Online';
                syncStatus.className = 'sync-status online';
            } else {
                syncStatus.textContent = 'Offline';
                syncStatus.className = 'sync-status offline';
            }
        }

        // Função para salvar progresso
        async function saveProgress() {
            // Salva localmente como fallback
            localStorage.setItem('progressData', JSON.stringify(progressData));
            localStorage.setItem('linkData', JSON.stringify(linkData));
            localStorage.setItem('studyCycleData', JSON.stringify(studyCycleData));
            
            // Tenta salvar no servidor
            try {
                const result = await makeRequest('saveProgress', {
                    progressData: progressData,
                    linkData: linkData,
                    studyCycleData: studyCycleData
                });
                
                if (result.success) {
                    console.log('Dados salvos no servidor');
                } else {
                    console.warn('Não foi possível salvar no servidor, usando localStorage');
                }
            } catch (error) {
                console.warn('Servidor offline, dados salvos localmente');
            }
            
            updateProgressDisplay();
            updateStudyCycleDisplay();
        }

        // Função para carregar progresso
        async function loadProgress() {
            try {
                const result = await makeRequest('getProgress');
                
                if (result.success) {
                    progressData = result.progressData || {};
                    linkData = result.linkData || {};
                    studyCycleData = result.studyCycleData || studyCycleData;
                } else {
                    // Fallback para localStorage
                    progressData = JSON.parse(localStorage.getItem('progressData')) || {};
                    linkData = JSON.parse(localStorage.getItem('linkData')) || {};
                    studyCycleData = JSON.parse(localStorage.getItem('studyCycleData')) || studyCycleData;
                }
            } catch (error) {
                console.warn('Erro ao carregar do servidor, usando localStorage');
                progressData = JSON.parse(localStorage.getItem('progressData')) || {};
                linkData = JSON.parse(localStorage.getItem('linkData')) || {};
                studyCycleData = JSON.parse(localStorage.getItem('studyCycleData')) || studyCycleData;
            }
            
            updateProgressDisplay();
            updateStudyCycleDisplay();
        }

        // Função para atualizar o display de progresso
        function updateProgressDisplay() {
            let totalItems = 0;
            let completedItems = 0;
            
            // Calcula progresso geral
            for (const org in progressData) {
                for (const category in progressData[org]) {
                    for (const item in progressData[org][category]) {
                        totalItems++;
                        if (progressData[org][category][item]) {
                            completedItems++;
                        }
                    }
                }
            }
            
            // Atualiza barra de progresso geral
            const progressPercent = totalItems > 0 ? (completedItems / totalItems) * 100 : 0;
            document.getElementById('overallProgress').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `${Math.round(progressPercent)}% concluído (${completedItems}/${totalItems} itens)`;
            
            // Atualiza progresso por categoria
            const categories = [
                'gestaoTI', 'contratacaoTI', 'inteligenciaArtificial', 
                'computacaoNuvem', 'segurancaInformacao', 'engenhariaSoftware',
                'engenhariaDados', 'infraestruturaTI'
            ];
            
            const currentOrg = document.getElementById('stateName').textContent;
            if (currentOrg && progressData[currentOrg]) {
                categories.forEach(category => {
                    const categoryData = progressData[currentOrg][category] || {};
                    const categoryItems = Object.keys(categoryData).length;
                    const completedCategoryItems = Object.values(categoryData).filter(val => val).length;
                    
                    const progressElement = document.getElementById(`${category}Progress`);
                    if (progressElement) {
                        progressElement.textContent = `${completedCategoryItems}/${categoryItems}`;
                    }
                });
            }
        }
        
        // Função para criar um item de conteúdo
        function createContentItem(text, org, category, index) {
            const itemId = `${org}-${category}-${index}`;
            const isCompleted = progressData[org] && progressData[org][category] && progressData[org][category][itemId];
            const itemLink = linkData[itemId] || null;
            
            const itemDiv = document.createElement('div');
            itemDiv.className = `content-item ${isCompleted ? 'completed' : ''}`;
            itemDiv.dataset.itemId = itemId;
            itemDiv.dataset.text = text.toLowerCase();
            itemDiv.dataset.category = category;
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.className = 'content-checkbox';
            checkbox.checked = isCompleted;
            
            checkbox.addEventListener('change', function() {
                // Atualiza dados de progresso
                if (!progressData[org]) progressData[org] = {};
                if (!progressData[org][category]) progressData[org][category] = {};
                progressData[org][category][itemId] = this.checked;
                
                // Atualiza visual
                itemDiv.classList.toggle('completed', this.checked);
                
                // Atualiza ciclo de estudos se estiver ativo
                if (studyCycleData.currentDiscipline === category) {
                    updateStudyCycleProgress();
                }
                
                saveProgress();
            });
            
            const textSpan = document.createElement('span');
            textSpan.className = 'content-text';
            textSpan.textContent = text;
            
            itemDiv.appendChild(checkbox);
            itemDiv.appendChild(textSpan);
            
            // Container para ações
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'content-actions';
            
            // Link para resumo
            if (itemLink) {
                const link = document.createElement('a');
                link.href = itemLink;
                link.className = 'content-link';
                link.textContent = 'Ver Resumo';
                link.target = '_blank';
                actionsDiv.appendChild(link);
                
                // Botão para editar link
                const editBtn = document.createElement('button');
                editBtn.className = 'edit-link-btn';
                editBtn.textContent = 'Editar';
                editBtn.addEventListener('click', function() {
                    showLinkInput(itemId, itemDiv, true);
                });
                actionsDiv.appendChild(editBtn);
            } else {
                const addLinkBtn = document.createElement('button');
                addLinkBtn.className = 'add-link-btn';
                addLinkBtn.textContent = '+ Link';
                addLinkBtn.addEventListener('click', function() {
                    showLinkInput(itemId, itemDiv, false);
                });
                actionsDiv.appendChild(addLinkBtn);
            }
            
            itemDiv.appendChild(actionsDiv);
            
            // Container para input de link
            const linkInputContainer = document.createElement('div');
            linkInputContainer.className = 'link-input-container';
            
            const linkInput = document.createElement('input');
            linkInput.type = 'text';
            linkInput.className = 'link-input';
            linkInput.placeholder = 'Cole aqui o link para seu resumo...';
            
            const linkActions = document.createElement('div');
            linkActions.className = 'link-actions';
            
            const saveBtn = document.createElement('button');
            saveBtn.className = 'link-save';
            saveBtn.textContent = 'Salvar';
            
            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'link-cancel';
            cancelBtn.textContent = 'Cancelar';
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'link-remove';
            removeBtn.textContent = 'Remover';
            
            linkActions.appendChild(saveBtn);
            linkActions.appendChild(cancelBtn);
            linkActions.appendChild(removeBtn);
            
            linkInputContainer.appendChild(linkInput);
            linkInputContainer.appendChild(linkActions);
            
            itemDiv.appendChild(linkInputContainer);
            
            return itemDiv;
        }
        
        // Função para mostrar input de link
        function showLinkInput(itemId, itemDiv, isEditing) {
            const linkInputContainer = itemDiv.querySelector('.link-input-container');
            const actionsDiv = itemDiv.querySelector('.content-actions');
            
            actionsDiv.style.display = 'none';
            linkInputContainer.style.display = 'block';
            
            const linkInput = linkInputContainer.querySelector('.link-input');
            const saveBtn = linkInputContainer.querySelector('.link-save');
            const cancelBtn = linkInputContainer.querySelector('.link-cancel');
            const removeBtn = linkInputContainer.querySelector('.link-remove');
            
            // Preenche o input se estiver editando
            if (isEditing) {
                linkInput.value = linkData[itemId] || '';
                removeBtn.style.display = 'block';
            } else {
                linkInput.value = '';
                removeBtn.style.display = 'none';
            }
            
            // Foca no input
            linkInput.focus();
            
            // Salvar link
            saveBtn.onclick = function() {
                const url = linkInput.value.trim();
                if (url) {
                    linkData[itemId] = url;
                    saveProgress();
                    
                    // Recria o item para atualizar a interface
                    const org = itemId.split('-')[0];
                    const category = itemId.split('-')[1];
                    const index = itemId.split('-')[2];
                    const text = itemDiv.querySelector('.content-text').textContent;
                    
                    const newItem = createContentItem(text, org, category, index);
                    itemDiv.parentNode.replaceChild(newItem, itemDiv);
                }
            };
            
            // Remover link
            removeBtn.onclick = function() {
                delete linkData[itemId];
                saveProgress();
                
                // Recria o item para atualizar a interface
                const org = itemId.split('-')[0];
                const category = itemId.split('-')[1];
                const index = itemId.split('-')[2];
                const text = itemDiv.querySelector('.content-text').textContent;
                
                const newItem = createContentItem(text, org, category, index);
                itemDiv.parentNode.replaceChild(newItem, itemDiv);
            };
            
            // Cancelar
            cancelBtn.onclick = function() {
                linkInputContainer.style.display = 'none';
                actionsDiv.style.display = 'flex';
            };
        }
        
        // Filtros
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Atualiza botões ativos
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const filter = this.dataset.filter;
                filterContentItems(filter);
            });
        });
        
        function filterContentItems(filter) {
            const allItems = document.querySelectorAll('.content-item');
            
            allItems.forEach(item => {
                const isCompleted = item.classList.contains('completed');
                
                switch(filter) {
                    case 'all':
                        item.style.display = 'flex';
                        break;
                    case 'pending':
                        item.style.display = isCompleted ? 'none' : 'flex';
                        break;
                    case 'completed':
                        item.style.display = isCompleted ? 'flex' : 'none';
                        break;
                }
            });
        }
        
        // Função para carregar conteúdo de um órgão
        function loadStateContent(stateId, stateName) {
            currentState = stateId;
            
            // Carrega os dados mais recentes
            loadProgress();
            
            // Atualiza o nome do órgão
            document.getElementById('stateName').textContent = stateName;
            
            // Mostra as seções de disciplinas
            document.querySelector('.state-categories').style.display = 'grid';
            
            // Limpa links anteriores
            const categories = [
                'gestaoTI', 'contratacaoTI', 'inteligenciaArtificial', 
                'computacaoNuvem', 'segurancaInformacao', 'engenhariaSoftware',
                'engenhariaDados', 'infraestruturaTI'
            ];
            
            categories.forEach(category => {
                const element = document.getElementById(category + 'Links');
                if (element) {
                    element.innerHTML = '';
                }
            });
            
            // Verifica se há dados para este órgão
            if (stateLinks[stateId]) {
                const links = stateLinks[stateId];
                
                // Adiciona conteúdo para cada categoria
                categories.forEach(category => {
                    const elementId = category + 'Links';
                    const element = document.getElementById(elementId);
                    
                    if (element && links[category] && links[category].length > 0) {
                        links[category].forEach((item, index) => {
                            const contentItem = createContentItem(item.text, stateName, category, index);
                            element.appendChild(contentItem);
                        });
                    } else if (element) {
                        element.innerHTML = '<p>Nenhum conteúdo disponível no momento</p>';
                    }
                });
            } else {
                // Se não houver dados para o órgão
                categories.forEach(category => {
                    const element = document.getElementById(category + 'Links');
                    if (element) {
                        element.innerHTML = '<p>Dados não disponíveis para este órgão</p>';
                    }
                });
            }
            
            // Mostra a seção de informações
            document.getElementById('stateInfo').style.display = 'block';
            
            // Atualiza display de progresso
            updateProgressDisplay();
            
            // Rola a página até a seção de informações
            document.getElementById('stateInfo').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Adiciona eventos de clique para cada botão de órgão
        document.querySelectorAll('.state-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const stateId = this.getAttribute('data-state');
                const stateName = this.textContent;
                loadStateContent(stateId, stateName);
            });
        });
        
        // Função de pesquisa aprimorada
        function performSearch(searchTerm, filterType) {
            searchTerm = searchTerm.toLowerCase().trim();
            
            if (!searchTerm) {
                // Se não há termo de pesquisa, mostra todos os órgãos
                document.querySelectorAll('.state-btn').forEach(btn => {
                    btn.style.display = 'block';
                });
                
                // Se já tem um órgão selecionado, mantém as disciplinas visíveis
                if (currentState) {
                    document.querySelectorAll('.category').forEach(category => {
                        category.style.display = 'block';
                    });
                    document.querySelectorAll('.content-item').forEach(item => {
                        item.style.display = 'flex';
                    });
                }
                return;
            }
            
            switch(filterType) {
                case 'orgao':
                    // Filtra apenas órgãos
                    document.querySelectorAll('.state-btn').forEach(btn => {
                        const stateName = btn.textContent.toLowerCase();
                        if (stateName.includes(searchTerm)) {
                            btn.style.display = 'block';
                        } else {
                            btn.style.display = 'none';
                        }
                    });
                    break;
                    
                case 'disciplina':
                    // Filtra disciplinas dentro do órgão atual
                    if (currentState) {
                        document.querySelectorAll('.category').forEach(category => {
                            const disciplinaName = category.getAttribute('data-disciplina').toLowerCase();
                            if (disciplinaName.includes(searchTerm)) {
                                category.style.display = 'block';
                            } else {
                                category.style.display = 'none';
                            }
                        });
                    } else {
                        // Se não há órgão selecionado, pesquisa em todos os órgãos
                        let found = false;
                        document.querySelectorAll('.state-btn').forEach(btn => {
                            const stateId = btn.getAttribute('data-state');
                            if (stateLinks[stateId]) {
                                for (const category in stateLinks[stateId]) {
                                    const categoryName = getCategoryDisplayName(category).toLowerCase();
                                    if (categoryName.includes(searchTerm)) {
                                        btn.style.display = 'block';
                                        found = true;
                                        break;
                                    }
                                }
                            }
                        });
                    }
                    break;
                    
                case 'conteudo':
                    // Filtra conteúdos específicos
                    if (currentState) {
                        document.querySelectorAll('.content-item').forEach(item => {
                            const itemText = item.dataset.text;
                            if (itemText.includes(searchTerm)) {
                                item.style.display = 'flex';
                            } else {
                                item.style.display = 'none';
                            }
                        });
                    }
                    break;
                    
                case 'all':
                default:
                    // Pesquisa em tudo
                    let foundInOrgao = false;
                    
                    // Primeiro pesquisa nos órgãos
                    document.querySelectorAll('.state-btn').forEach(btn => {
                        const stateName = btn.textContent.toLowerCase();
                        const stateId = btn.getAttribute('data-state');
                        
                        if (stateName.includes(searchTerm)) {
                            btn.style.display = 'block';
                            foundInOrgao = true;
                        } else if (stateLinks[stateId]) {
                            // Pesquisa nas disciplinas do órgão
                            let foundInDisciplina = false;
                            for (const category in stateLinks[stateId]) {
                                const categoryName = getCategoryDisplayName(category).toLowerCase();
                                if (categoryName.includes(searchTerm)) {
                                    btn.style.display = 'block';
                                    foundInOrgao = true;
                                    foundInDisciplina = true;
                                    break;
                                }
                            }
                            
                            if (!foundInDisciplina) {
                                btn.style.display = 'none';
                            }
                        } else {
                            btn.style.display = 'none';
                        }
                    });
                    
                    // Se há um órgão selecionado, pesquisa também nos conteúdos
                    if (currentState) {
                        document.querySelectorAll('.category').forEach(category => {
                            const disciplinaName = category.getAttribute('data-disciplina').toLowerCase();
                            if (disciplinaName.includes(searchTerm)) {
                                category.style.display = 'block';
                            } else {
                                // Verifica se há conteúdos que correspondem
                                const items = category.querySelectorAll('.content-item');
                                let hasMatchingItems = false;
                                
                                items.forEach(item => {
                                    const itemText = item.dataset.text;
                                    if (itemText.includes(searchTerm)) {
                                        item.style.display = 'flex';
                                        hasMatchingItems = true;
                                    } else {
                                        item.style.display = 'none';
                                    }
                                });
                                
                                category.style.display = hasMatchingItems ? 'block' : 'none';
                            }
                        });
                    }
                    break;
            }
        }
        
        // Função auxiliar para obter o nome de exibição da categoria
        function getCategoryDisplayName(categoryKey) {
            const categoryMap = {
                'gestaoTI': 'GESTÃO DE TI',
                'contratacaoTI': 'CONTRATAÇÕES DE TI',
                'inteligenciaArtificial': 'INTELIGÊNCIA ARTIFICIAL',
                'computacaoNuvem': 'COMPUTAÇÃO EM NUVEM',
                'segurancaInformacao': 'SEGURANÇA DA INFORMAÇÃO',
                'engenhariaSoftware': 'ENGENHARIA DE SOFTWARE',
                'engenhariaDados': 'ENGENHARIA DE DADOS',
                'infraestruturaTI': 'INFRAESTRUTURA DE TI'
            };
            
            return categoryMap[categoryKey] || categoryKey;
        }
        
        // Event listener para a pesquisa
        document.querySelector('.search-input').addEventListener('input', function(e) {
            const searchTerm = e.target.value;
            const filterType = document.querySelector('input[name="search-filter"]:checked').value;
            performSearch(searchTerm, filterType);
        });
        
        // Event listener para os filtros de pesquisa
        document.querySelectorAll('input[name="search-filter"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const searchTerm = document.querySelector('.search-input').value;
                performSearch(searchTerm, this.value);
            });
        });

        // Botão de sincronização manual
        document.getElementById('syncButton').addEventListener('click', async function() {
            await loadProgress();
            alert('Dados sincronizados!');
        });
        
        // ========== SISTEMA DE CICLO DE ESTUDOS ==========
        
        // Iniciar ciclo de estudos
        document.getElementById('startCycleBtn').addEventListener('click', function() {
            const currentOrg = document.getElementById('stateName').textContent;
            if (!currentOrg || currentOrg === 'Órgão') {
                alert('Selecione um órgão primeiro!');
                return;
            }
            
            // Encontra a disciplina com menor progresso
            const categories = [
                'gestaoTI', 'contratacaoTI', 'inteligenciaArtificial', 
                'computacaoNuvem', 'segurancaInformacao', 'engenhariaSoftware',
                'engenhariaDados', 'infraestruturaTI'
            ];
            
            let minProgress = 100;
            let selectedDiscipline = null;
            
            categories.forEach(category => {
                const categoryData = progressData[currentOrg] && progressData[currentOrg][category] ? progressData[currentOrg][category] : {};
                const totalItems = Object.keys(categoryData).length;
                const completedItems = Object.values(categoryData).filter(val => val).length;
                const progress = totalItems > 0 ? (completedItems / totalItems) * 100 : 0;
                
                if (progress < minProgress && totalItems > 0) {
                    minProgress = progress;
                    selectedDiscipline = category;
                }
            });
            
            if (!selectedDiscipline) {
                alert('Nenhuma disciplina com conteúdo disponível encontrada!');
                return;
            }
            
            startStudyCycle(selectedDiscipline, currentOrg);
        });
        
        // Função para iniciar ciclo de estudos
        function startStudyCycle(discipline, org) {
            studyCycleData.currentDiscipline = discipline;
            studyCycleData.currentDay = 1;
            studyCycleData.totalDays = 7;
            
            // Inicializa dados do ciclo se não existirem
            if (!studyCycleData.days[discipline]) {
                studyCycleData.days[discipline] = {};
                for (let day = 1; day <= studyCycleData.totalDays; day++) {
                    studyCycleData.days[discipline][day] = {
                        completed: false,
                        items: {}
                    };
                }
            }
            
            // Distribui os itens da disciplina pelos dias
            const disciplineItems = stateLinks[currentState][discipline] || [];
            const itemsPerDay = Math.ceil(disciplineItems.length / studyCycleData.totalDays);
            
            for (let day = 1; day <= studyCycleData.totalDays; day++) {
                const startIndex = (day - 1) * itemsPerDay;
                const endIndex = Math.min(startIndex + itemsPerDay, disciplineItems.length);
                const dayItems = disciplineItems.slice(startIndex, endIndex);
                
                studyCycleData.days[discipline][day].plannedItems = dayItems.map((item, index) => ({
                    text: item.text,
                    itemId: `${org}-${discipline}-${startIndex + index}`
                }));
            }
            
            document.getElementById('currentDisciplineName').textContent = getCategoryDisplayName(discipline);
            document.getElementById('studyCycleContainer').style.display = 'block';
            
            updateStudyCycleDisplay();
            saveProgress();
            
            // Rola até o ciclo de estudos
            document.getElementById('studyCycleContainer').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Atualizar display do ciclo de estudos
        function updateStudyCycleDisplay() {
            const cycleContent = document.getElementById('studyCycleContent');
            cycleContent.innerHTML = '';
            
            const discipline = studyCycleData.currentDiscipline;
            if (!discipline) return;
            
            for (let day = 1; day <= studyCycleData.totalDays; day++) {
                const dayData = studyCycleData.days[discipline][day] || { completed: false, items: {}, plannedItems: [] };
                const dayElement = document.createElement('div');
                dayElement.className = 'cycle-day';
                
                if (day === studyCycleData.currentDay) {
                    dayElement.classList.add('current');
                } else if (day < studyCycleData.currentDay) {
                    dayElement.classList.add('completed');
                } else {
                    dayElement.classList.add('future');
                }
                
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                
                const dayTitle = document.createElement('div');
                dayTitle.className = 'day-title';
                dayTitle.textContent = `Dia ${day}`;
                
                const dayStatus = document.createElement('div');
                dayStatus.className = 'day-status';
                
                if (day === studyCycleData.currentDay) {
                    dayStatus.textContent = 'HOJE';
                    dayStatus.classList.add('current');
                } else if (day < studyCycleData.currentDay) {
                    dayStatus.textContent = 'CONCLUÍDO';
                    dayStatus.classList.add('completed');
                } else {
                    dayStatus.textContent = 'FUTURO';
                }
                
                dayHeader.appendChild(dayTitle);
                dayHeader.appendChild(dayStatus);
                dayElement.appendChild(dayHeader);
                
                const studyItems = document.createElement('ul');
                studyItems.className = 'study-items';
                
                if (dayData.plannedItems) {
                    dayData.plannedItems.forEach(plannedItem => {
                        const itemElement = document.createElement('li');
                        itemElement.className = 'study-item';
                        
                        const isCompleted = progressData[document.getElementById('stateName').textContent] && 
                                          progressData[document.getElementById('stateName').textContent][discipline] && 
                                          progressData[document.getElementById('stateName').textContent][discipline][plannedItem.itemId];
                        
                        if (isCompleted) {
                            itemElement.classList.add('completed');
                        }
                        
                        if (day === studyCycleData.currentDay && !isCompleted) {
                            itemElement.classList.add('current');
                        }
                        
                        itemElement.textContent = plannedItem.text;
                        studyItems.appendChild(itemElement);
                    });
                }
                
                dayElement.appendChild(studyItems);
                cycleContent.appendChild(dayElement);
            }
            
            updateStudyCycleProgress();
        }
        
        // Atualizar progresso do ciclo
        function updateStudyCycleProgress() {
            const discipline = studyCycleData.currentDiscipline;
            if (!discipline) return;
            
            let totalItems = 0;
            let completedItems = 0;
            
            for (let day = 1; day <= studyCycleData.totalDays; day++) {
                const dayData = studyCycleData.days[discipline][day];
                if (dayData && dayData.plannedItems) {
                    dayData.plannedItems.forEach(plannedItem => {
                        totalItems++;
                        const isCompleted = progressData[document.getElementById('stateName').textContent] && 
                                          progressData[document.getElementById('stateName').textContent][discipline] && 
                                          progressData[document.getElementById('stateName').textContent][discipline][plannedItem.itemId];
                        if (isCompleted) {
                            completedItems++;
                        }
                    });
                }
            }
            
            const progressPercent = totalItems > 0 ? (completedItems / totalItems) * 100 : 0;
            document.getElementById('cycleProgressFill').style.width = `${progressPercent}%`;
            document.getElementById('cycleProgressText').textContent = `Progresso do Ciclo: ${Math.round(progressPercent)}%`;
            document.getElementById('cycleDayInfo').textContent = `Dia ${studyCycleData.currentDay} de ${studyCycleData.totalDays}`;
            
            // Avança automaticamente para o próximo dia se todos os itens do dia atual foram concluídos
            if (studyCycleData.currentDay <= studyCycleData.totalDays) {
                const currentDayData = studyCycleData.days[discipline][studyCycleData.currentDay];
                if (currentDayData && currentDayData.plannedItems) {
                    const allCurrentDayCompleted = currentDayData.plannedItems.every(plannedItem => {
                        return progressData[document.getElementById('stateName').textContent] && 
                               progressData[document.getElementById('stateName').textContent][discipline] && 
                               progressData[document.getElementById('stateName').textContent][discipline][plannedItem.itemId];
                    });
                    
                    if (allCurrentDayCompleted && studyCycleData.currentDay < studyCycleData.totalDays) {
                        studyCycleData.currentDay++;
                        updateStudyCycleDisplay();
                        saveProgress();
                    }
                }
            }
        }
        
        // Navegação do ciclo
        document.getElementById('prevDayBtn').addEventListener('click', function() {
            if (studyCycleData.currentDay > 1) {
                studyCycleData.currentDay--;
                updateStudyCycleDisplay();
                saveProgress();
            }
        });
        
        document.getElementById('nextDayBtn').addEventListener('click', function() {
            if (studyCycleData.currentDay < studyCycleData.totalDays) {
                studyCycleData.currentDay++;
                updateStudyCycleDisplay();
                saveProgress();
            }
        });
        
        document.getElementById('resetCycleBtn').addEventListener('click', function() {
            if (confirm('Tem certeza que deseja reiniciar o ciclo de estudos?')) {
                studyCycleData.currentDay = 1;
                updateStudyCycleDisplay();
                saveProgress();
            }
        });
        
        // Carrega os dados quando a página inicia
        document.addEventListener('DOMContentLoaded', async function() {
            await loadProgress();
            updateProgressDisplay();
            updateSyncStatus();
            
            // Mostra o ciclo de estudos se houver um ativo
            if (studyCycleData.currentDiscipline) {
                document.getElementById('studyCycleContainer').style.display = 'block';
                document.getElementById('currentDisciplineName').textContent = getCategoryDisplayName(studyCycleData.currentDiscipline);
                updateStudyCycleDisplay();
            }
        });
    </script>
</body>
</html>
